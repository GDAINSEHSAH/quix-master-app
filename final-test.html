<!DOCTYPE html>
<html>
<head>
    <title>‚úÖ Final Question Count Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
        .container { max-width: 800px; margin: 0 auto; background: rgba(255,255,255,0.1); padding: 30px; border-radius: 20px; }
        .test-result { margin: 15px 0; padding: 15px; border-radius: 10px; background: rgba(255,255,255,0.1); }
        .success { border-left: 5px solid #4CAF50; }
        .warning { border-left: 5px solid #FF9800; }
        .error { border-left: 5px solid #f44336; }
        button { background: #4CAF50; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; margin: 10px; }
        button:hover { background: #45a049; }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚úÖ Final Question Count Verification</h1>
        <p>Testing the exact same logic used in the main quiz app...</p>

        <div id="results"></div>

        <button onclick="runTest()">üîÑ Run Test</button>
        <button onclick="window.open('https://gdainsehsah.github.io/quix-master-app/', '_blank')">üöÄ Test Live App</button>
    </div>

    <script src="data/questions.js"></script>
    <script>
        function log(message, type = 'normal') {
            const div = document.createElement('div');
            div.className = `test-result ${type}`;
            div.innerHTML = message;
            document.getElementById('results').appendChild(div);
        }

        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        function runTest() {
            document.getElementById('results').innerHTML = '';

            log('üöÄ Starting Final Question Count Test...', 'success');

            if (typeof QUIZ_DATABASE === 'undefined') {
                log('‚ùå CRITICAL ERROR: QUIZ_DATABASE not loaded!', 'error');
                return;
            }

            log('‚úÖ QUIZ_DATABASE loaded successfully', 'success');

            // Convert the comprehensive database to simplified format (EXACT SAME LOGIC AS INDEX.HTML)
            let quizData = {};
            if (typeof QUIZ_DATABASE !== 'undefined') {
                Object.keys(QUIZ_DATABASE).forEach(sectionKey => {
                    const section = QUIZ_DATABASE[sectionKey];
                    quizData[sectionKey] = [];

                    // Combine questions from all levels (1-10)
                    for (let level = 1; level <= 10; level++) {
                        if (section.levels && section.levels[level]) {
                            quizData[sectionKey] = quizData[sectionKey].concat(section.levels[level]);
                        }
                    }

                    // Shuffle questions for variety
                    quizData[sectionKey] = shuffleArray(quizData[sectionKey]);
                });
            }

            // Test each section
            Object.keys(quizData).forEach(section => {
                const available = quizData[section].length;
                const maxQuestions = Math.min(15, quizData[section].length);
                const testQuiz = quizData[section].slice(0, maxQuestions);

                let resultType = 'success';
                let icon = '‚úÖ';

                if (maxQuestions < 10) {
                    resultType = 'warning';
                    icon = '‚ö†Ô∏è';
                } else if (maxQuestions < 5) {
                    resultType = 'error';
                    icon = '‚ùå';
                }

                log(`${icon} <strong>${section.toUpperCase()}</strong>: ${available} total questions ‚Üí ${maxQuestions} per quiz session`, resultType);

                // Show first few question titles as proof
                const examples = testQuiz.slice(0, 3).map(q => q.question.substring(0, 50) + '...').join('<br>&nbsp;&nbsp;&nbsp;‚Ä¢ ');
                log(`&nbsp;&nbsp;&nbsp;Sample questions:<br>&nbsp;&nbsp;&nbsp;‚Ä¢ ${examples}`, 'normal');
            });

            const grandTotal = Object.values(quizData).reduce((sum, questions) => sum + questions.length, 0);
            log(`<br>üèÜ <strong>SUMMARY</strong>: ${grandTotal} total questions across all sections`, 'success');
            log(`üìä Each quiz session will now provide 10-15 questions instead of 4!`, 'success');
            log(`üéØ The user's issue "getting only 4 questions" should now be RESOLVED`, 'success');
        }

        // Auto-run test
        window.addEventListener('load', runTest);
    </script>
</body>
</html>